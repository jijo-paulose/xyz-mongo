# Introduction #

XyzMongoDs对mongodb java driver进行了封装，简化了编程，对于一些基本的curd工作，几乎做到不写一行代码即可完成[XyzMongoDsServletGetStart](http://code.google.com/p/xyz-mongo/wiki/XyzMongoDsServletGetStart)。


# Details #

使用方法：
  * 下载xyz.mongo.core & xyz.mongo.ds.
  * 建立java工程，将xyz.mongo.core.0.1.jar & xyz.mongo.ds.0.1.jar加入，同时加入junit，appache common id，common log，log4j，mongo driver & spring相关jar包.
  * 在classpath跟目录下加入spring配置文件：[app-xyz.xml](http://code.google.com/p/xyz-mongo/source/browse/wiki/wikifile/app-xyz.xml) & [global-xyz.xml](http://code.google.com/p/xyz-mongo/source/browse/wiki/wikifile/global-xyz.xml)
  * 在classpath的json4ds目录下放入：[basetable.json](http://code.google.com/p/xyz-mongo/source/browse/wiki/wikifile/json4ds/basetable.json),缺省支持20种操作（不写一行代码即可完成）。

  * 下面以表user为例介绍mongods的使用，表user结构：[user.dsl](http://code.google.com/p/xyz-mongo/source/browse/wiki/wikifile/json4ds/user.dsl)

**不用写json就能支持的操作**|操作|mongo shell|basetable.json相关部分|java代码,获取mds部分：`ApplicationContext context=new ClassPathXmlApplicationContext("app-xyz.xml");IMongoDataSourceManager mongoDataSourceManager=(IMongoDataSourceManager)context.getBean("mongoDataSourceManager");IMongoDataSource mds=mongoDataSourceManager.getMongoDataSource();`|
|:-|:----------|:-----------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|根据Id查找所有字段|`db.user.find({_id:'idvalue'})`|`findById:{type:"one",checkargs:['id'],value:"{_id:'${id}'}",fields:"{_class:0}",comment:"find all fields by id"`}|` mds.col("user","findById",(DBObject)JSON.parse("{id:'idvalue'}"); `                                                                                                                                                                                                            |
|根据Id,字段名查找所有指定字段(uName,psword)|`db.user.find({_id:'idvalue'},{uName:1,psword:1})`|`findFieldsById:{type:"one",checkargs:['id','names'],value:"{_id:'${id}'}",fields:"{<#list names as name>${name}:1,</#list>_id:0}",comment:"find  field by id and field names"`}|` mds.col("user","findFieldsById",(DBObject)JSON.parse("{id:'idvalue',names:['uName','psword']}"); `                                                                                                                                                                             |
|根据给定多个id查找所有字段|`db.user.find({_id:{$in:['a','b']}},{uName:1,psword:1})`|`listByIds:{type:"list",checkargs:['ids'],value:"{_id:{$in:[<#list ids as id>'${id}'<#if id_has_next>,</#if></#list>]}}",fields:"{}",comment:"list all field by ids"`}|` mds.col("user","listByIds",(DBObject)JSON.parse("{ids:['a','b']}"); `                                                                                                                                                                                                          |
|根据给定多个id,字段名查找所有指定字段|`db.user.find({_id:{$in:['a','b']},{uName:1,psword:1})；`|`listFieldsByIds:{type:"list",checkargs:['ids','names'],value:"{_id:{$in:[<#list ids as id>'${id}'<#if id_has_next>,</#if></#list>]}}",fields:"{<#list names as name>${name}:1<#if name_has_next>,</#if></#list>}",comment:"list  fields by ids and names"`}|` mds.col("user","listFieldsByIds",(DBObject)JSON.parse("{ids:['a','b'],names:['uName','psword']}"); `                                                                                                                                                                           |
|根据给定id查找指定字段|`db.user.find({_id:'a'},{uName:1})；`|`findFieldById:{type:"one",checkargs:['id','name'],value:"{_id:${id}}",fields:"{${name}:1,_id:0}",comment:"find  field by id and field name"`}|` mds.col("user","findFieldById",(DBObject)JSON.parse("{id:'a',name:'uName'}"); `                                                                                                                                                                                                |
|根据给定id,字段名，值来更新数字字段|`db.user.update({_id:'a'},$set:{team:1})；`|`updateNumById:{type:"upone",checkargs:['id','name','value'],value:"{_id:'${id}'}",update:"{$set:{${name}:${value`",comment:"update number field value by id and new value"}}}}|` mds.col("user","updateNumById",(DBObject)JSON.parse("{id:'a',name:'team',value:1}"); `                                                                                                                                                                                         |
|根据给定id,字段名，值来更新字符字段|`db.user.update({_id:'a'},$set:{uName:'a'})；`|`updateStrById:{type:"upone",checkargs:['id','name','value'],value:"{_id:'${id}'}",update:"{$set:{${name}:'${value}'}}",comment:"update number field value by id and new value"`}|` mds.col("user","updateStrById",(DBObject)JSON.parse("{id:'a',name:'uName',value:'a'}"); `                                                                                                                                                                                      |
|根据传递query查询所有字段|`db.user.find({uName:'uName',team:1})`|`q:{type:"list",checkargs:['q'],value:"${q}}",fields:"{}",comment:"list all field by query"`}|` mds.col("user","q",(DBObject)JSON.parse("{q:{uName:'uName',team:1}}"); `                                                                                                                                                                                                       |
|根据传递query,field查询相关字段|`db.user.find({uName:\uName\,team:1},{uName:1,psword:1})`|`qf:{type:"list",checkargs:['q','f'],value:"${q}}",fields:"${f}",comment:"list all field by query,and fields"`}|` mds.col("user","qf",(DBObject)JSON.parse("{q:{uName:{$regex:'uName','$options':'i'},team:1},f:{uName:1,psword:1}}"); `                                                                                                                                                         |
|根据传递query查询count|`db.user.count({uName:\uName\,team:1})`|`qc:{type:"count",checkargs:['q'],value:"${q}}",fields:"{_id:1}",comment:"count by query"`}|` mds.col("user","qc",(DBObject)JSON.parse("{q:{uName:{$regex:'uName','$options':'i'},team:1}}"); `                                                                                                                                                                              |
|根据传递query查询是否存在|无          |`qe:{type:"exist",checkargs:['q'],value:"${q}}",fields:"{_id:1}",comment:"exists by query"`}|` mds.col("user","qe",(DBObject)JSON.parse("{q:{uName:{$regex:'uName','$options':'i'},team:1}}"); `                                                                                                                                                                              |
|根据传递query查询一个对象|无          |`qo:{type:"one",checkargs:['q'],value:"${q}}",fields:"{}",comment:"find one by query"`}|` mds.col("user","qo",(DBObject)JSON.parse("{q:{uName:{$regex:'uName','$options':'i'},team:1}}"); `                                                                                                                                                                              |
|根据传递query，sort查询一个对象|无          |`qos:{type:"one",checkargs:['q','s'],value:"${q}}",sorts:"${s}",comment:"find one by query，sorts"`}|` mds.col("user","qos",(DBObject)JSON.parse("{q:{uName:{$regex:'uName','$options':'i'},team:1},s:'{uName:-1}'}"); `                                                                                                                                                              |
|根据传递query,field查询一个对象|无          |`qfo:{type:"one",checkargs:['q','f'],value:"${q}}",fields:"${f}",comment:"find one fields by query and fields"`}|` mds.col("user","qfo",(DBObject)JSON.parse("{q:{uName:{$regex:'uName','$options':'i'},team:1},f:{}}"); `                                                                                                                                                                        |
|根据传递query,field,sorts查询一个对象|无          |`qfs:{type:"one",checkargs:['q','f','s'],value:"${q}}",fields:"${f}",sorts:"${s}",comment:"find one fields by query and fields,sorts"`}|` mds.col("user","qfs",(DBObject)JSON.parse("{q:{uName:{$regex:'uName','$options':'i'},team:1},f:{},s:{uName:-1}}"); `                                                                                                                                                           |




